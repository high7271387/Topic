<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>產品內容</title>
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
    <link rel="stylesheet" href="CSS/nav.css">
    <link rel="stylesheet" href="CSS/footer.css">
    <script src='JS/js.cookie.min.js'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/axios/0.9.1/axios.js' integrity='sha512-Kg0CewqPNO/ziOJuCq5eyl3P/V6OLz/Lb1I2m+yKS3lHZcGVFN/KOew18rWP+kTsL7haYdaqGjwHQCZrN0heLQ==' crossorigin='anonymous'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/vue/2.6.9/vue.js' integrity='sha512-o9SZrtqlGkpa7EF+dDrNjEdRFFYhymlrBzDKpolHNolxsyx0IcXAbEm9i1e8QpoiMgEdKZVtY8XiK1t8i6jVDA==' crossorigin='anonymous'></script>
    <style>
    body{
        margin: 0;
        padding: 0;
        background-color: black;
        color:white;
    }
    header{
        padding-top: 120px;
        height:70vw;
        width:100%;
        /* background-color: yellowgreen; */
    }
    header img{
        height: 100%;
        width: 100%;
    }
    header .error{
        position: absolute;
        font-size: 2rem;
        font-weight: bold;
        top: 50%;
        left: 50%;
        transform: translate(-50%,-50%);
    }
    .sk-chase {
            width: 40px;
            height: 40px;
            position: relative;
            animation: sk-chase 2.5s infinite linear both;
        }

        .sk-chase-dot {
            width: 100%;
            height: 100%;
            position: absolute;
            left: 0;
            top: 0; 
            animation: sk-chase-dot 2.0s infinite ease-in-out both; 
        }

        .sk-chase-dot:before {
            content: '';
            display: block;
            width: 25%;
            height: 25%;
            background-color: #fff;
            border-radius: 100%;
            animation: sk-chase-dot-before 2.0s infinite ease-in-out both; 
        }

        .sk-chase-dot:nth-child(1) { animation-delay: -1.1s; }
        .sk-chase-dot:nth-child(2) { animation-delay: -1.0s; }
        .sk-chase-dot:nth-child(3) { animation-delay: -0.9s; }
        .sk-chase-dot:nth-child(4) { animation-delay: -0.8s; }
        .sk-chase-dot:nth-child(5) { animation-delay: -0.7s; }
        .sk-chase-dot:nth-child(6) { animation-delay: -0.6s; }
        .sk-chase-dot:nth-child(1):before { animation-delay: -1.1s; }
        .sk-chase-dot:nth-child(2):before { animation-delay: -1.0s; }
        .sk-chase-dot:nth-child(3):before { animation-delay: -0.9s; }
        .sk-chase-dot:nth-child(4):before { animation-delay: -0.8s; }
        .sk-chase-dot:nth-child(5):before { animation-delay: -0.7s; }
        .sk-chase-dot:nth-child(6):before { animation-delay: -0.6s; }

        @keyframes sk-chase {
            100% { transform: rotate(360deg); } 
        }

        @keyframes sk-chase-dot {
            80%, 100% { transform: rotate(360deg); } 
        }

        @keyframes sk-chase-dot-before {
            50% {
                transform: scale(0.4); 
            } 
            100%, 0% {
                transform: scale(1.0); 
            } 
        }
    main{
        margin-top: 50px;
        margin-bottom: 50px;
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
    }
    section.color{
        width:80%;
    }
    main .color h2, main .specification h2{
        position: relative;
        text-align: center;
    }
    main .color h2::after, main .specification h2::after{
        content:'';
        position:absolute;
        border:2px solid whitesmoke;
        width:100%;
        top:50%;
        left:0;
        transform: translateY(-50%);
        z-index: -1;
    }       
    main .color h2 span,main .specification h2 span{
        z-index: 50;
        width: 180px;
        display: inline-block;
        background: #000;
        font-size: 1.6rem;
    }
    main .color .colorlist{
        margin-top: 20px;
        display: flex;
        flex-wrap: wrap;
        justify-content:space-around;
        /* background-color: chartreuse; */
        margin-bottom: 20px;
    }
    main .color .colorlist h3{
        width: 100%;
        height: 30px;
        line-height: 30px;
        text-align: center;
        font-size: 1.4rem;
    }
    main .color .colorlist h3 span{
        background-color: rgb(236, 174, 97);
        padding: 10px 15px 10px 15px;
        border: 2px solid whitesmoke;
        border-radius: 15px;
        color: #000;
    }
    main .color .colorlist .coloritem{
        width:300px;
        height: 300px;
        /* background-color: brown; */
        text-align: center;
        margin-top: 20px;
    }
    main .color .colorlist .coloritem img{
        width:270px;
        height: 270px;
    }
    main .specification{
        width: 80%;
    }
    main .specification .specificationSelect{
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-top: 20px;
    }
    main .specification .specificationSelect select{
        margin-bottom: 20px;
        text-align: center;
        height: 30px;
        width: 200px;
        background-color: blanchedalmond;
        font-size: large;
        font-weight: bolder;
        font-family: '微軟正黑體';
    }
    main .specification .specificationSelect table{
        width:400px;
        text-align: center;
        border:2px #fff solid;
        font-weight: 600;
        margin-bottom: 20px;
    }
    main .specification .specificationSelect table tr{
        line-height: 24px;
    }
    main .specification .specificationSelect table td{
        border:2px #fff solid;
    }
    main .specification .specificationSelect table tr:nth-child(odd){
        background-color: rgb(119, 119, 119);
    }
    main .specificationSelect  button {
            background: none;
            color: white;
            padding: 10px 30px;
            font-size: 1.2rem;
            font-weight: bold;
            border-radius: 29px;
            cursor: pointer;
        } 
    footer{
        text-align: center;
    }
    @media screen and (max-width:576px){
        header{
            padding-top: 60px;
        }
    }
    @media screen and (max-width:400px){
        main .specification .specificationSelect table{
            width:350px;
        }
    }
    </style>
</head>
<body>
    <nav>
        <div class="logo"><a href="index.html"> </a></div>
        <div class='buttonarea'>
            <button type='button'><i class="fas fa-align-justify fa-2x"></i></button>
        </div>
        <div class="navlist" id='listItem'>
            <div class="product"> <a href="productList.html"></a> </div>
            <div class="news"> <a href="news.html"></a> </div>
            <div class="member"><a href="userdata.html"></a></div>
            <div class="about"> <a href="shoppingCart.html"></a></div>
        </div>
    </nav>

    <header id='header'>
        <img :src="'image/'+id+'/'+headerSrc" alt="" v-if='headerSrc'>
        <div v-if='!headerSrc && !status'>
            <div class="sk-chase" style="margin: auto;">
                <div class="sk-chase-dot"></div>
                <div class="sk-chase-dot"></div>
                <div class="sk-chase-dot"></div>
                <div class="sk-chase-dot"></div>
                <div class="sk-chase-dot"></div>
                <div class="sk-chase-dot"></div>
            </div>
        </div>
        <div v-if='!headerSrc && status' class="error">
            很抱歉，找不到對應的商品。
        </div>
    </header>

    <style>
    </style>
    <main id='productContent'  v-if='status && resdata'>
        <section class='color'>
            <h2><span>車色展示</span></h2>

            <div class="colorlist" v-for='list of resdata' v-if='list.color1'>
                <h3 class="colorClassName" v-if='list.classname'>
                    <span>{{list.classname}}</span>
                </h3>
                <div class="coloritem" >
                    <img :src="'image/'+id+'/'+ list.color1"  alt="">
                    <div class="colorName">{{list.DescriptionColor1}}</div>
                </div>
                <div class="coloritem" v-if="list.color2!= '' ">
                    <img :src="'image/'+id+'/'+ list.color2"  alt="">
                    <div class="colorName">{{list.DescriptionColor2}}</div>
                </div>
                <div class="coloritem"  v-if="list.color3!= '' ">
                    <img :src="'image/'+id+'/'+ list.color3"  alt="">
                    <div class="colorName">{{list.DescriptionColor3}}</div>
                </div>
                <div class="coloritem"  v-if="list.color4!= '' ">
                    <img :src="'image/'+id+'/'+ list.color4"  alt="">
                    <div class="colorName">{{list.DescriptionColor4}}</div>
                </div>
                <div class="coloritem"  v-if="list.color5!= '' ">
                    <img :src="'image/'+id+'/'+ list.color5"  alt="">
                    <div class="colorName">{{list.DescriptionColor5}}</div>
                </div>
            </div>
        </section>

        <section class="specification">
            <h2><span>性能規格</span></h2>
            <div class="specificationSelect">
                <select name="specification" id="specification" v-model='selected'>
                    <option disabled value=''>請選擇</option>
                    <option v-for='item of resdata' :value='item.name'>{{item.name}}</option>
                </select>
                <table >
                    <tr >
                        <td>機種名稱</td>
                        <td>{{content.name}}</td>
                    </tr>
                    <tr v-if='price'>
                        <td style="border:1px #fff solid;">售價</td>
                        <td>{{price}}</td>
                    </tr>
                    <tr v-if='content.LWH'>
                        <td style="border:1px #fff solid;">長寬高</td>
                        <td>{{content.LWH}}</td>
                    </tr>
                    <tr v-if='content.Wheelbase'>
                        <td style="border:1px #fff solid;">軸距</td>
                        <td>{{content.Wheelbase}}</td>
                    </tr>
                    <tr v-if='content.Displacement'>
                        <td style="border:1px #fff solid;">排氣量(CC)</td>
                        <td>{{content.Displacement}}</td>
                    </tr>
                    <tr v-if='content.Engine'>
                        <td style="border:1px #fff solid;">引擎形式</td>
                        <td>{{content.Engine}}</td>
                    </tr>
                    <tr v-if='content.Tire_front'>
                        <td style="border:1px #fff solid;">輪胎(前)</td>
                        <td>{{content.Tire_front}}</td>
                    </tr>
                    <tr v-if='content.Tirerear'>
                        <td style="border:1px #fff solid;">輪胎(後)</td>
                        <td>{{content.Tirerear}}</td>
                    </tr>
                    <tr v-if='content.Curbweight'>
                        <td style="border:1px #fff solid;">整備重量(kg)</td>
                        <td>{{content.Curbweight}}</td>
                    </tr>
                    <tr v-if='content.Frontbrake'>
                        <td style="border:1px #fff solid;">前煞系統</td>
                        <td>{{content.Frontbrake}}</td>
                    </tr>
                    <tr v-if='content.Wheelbase'>
                        <td style="border:1px #fff solid;">軸距</td>
                        <td>{{content.Wheelbase}}</td>
                    </tr>
                    <tr v-if='content.brakediameter'>
                        <td style="border:1px #fff solid;">前煞車直徑(φ)</td>
                        <td>{{content.brakediameter}}</td>
                    </tr>
                    <tr v-if='content.Rearbrake'>
                        <td style="border:1px #fff solid;">後煞系統</td>
                        <td>{{content.Rearbrake}}</td>
                    </tr>
                    <tr v-if='content.Frontmaterial'>
                        <td style="border:1px #fff solid;">前輪材質</td>
                        <td>{{content.Frontmaterial}}</td>
                    </tr>
                    <tr v-if='content.Rearwheelmaterial'>
                        <td style="border:1px #fff solid;">後輪材質</td>
                        <td>{{content.Rearwheelmaterial}}</td>
                    </tr>
                    <tr v-if='content.Headlight'>
                        <td style="border:1px #fff solid;">前大燈</td>
                        <td>{{content.Headlight}}</td>
                    </tr>
                    <tr v-if='content.Positioning_light'>
                        <td style="border:1px #fff solid;">定位燈</td>
                        <td>{{content.Positioning_light}}</td>
                    </tr>
                    <tr v-if='content.brake_lights'>
                        <td style="border:1px #fff solid;">尾燈&煞車燈</td>
                        <td>{{content.brake_lights}}</td>
                    </tr>
                    <tr v-if='content.Frontturn'>
                        <td style="border:1px #fff solid;">前方向燈</td>
                        <td>{{content.Frontturn}}</td>
                    </tr>
                    <tr v-if='content.Rear_direction'>
                        <td style="border:1px #fff solid;">後方向燈</td>
                        <td>{{content.Rear_direction}}</td>
                    </tr>
                    <tr v-if='content.Dashboard'>
                        <td style="border:1px #fff solid;">儀錶板</td>
                        <td>{{content.Dashboard}}</td>
                    </tr>
                    <tr v-if='content.Main_switch'>
                        <td style="border:1px #fff solid;">主開關</td>
                        <td>{{content.Main_switch}}</td>
                    </tr>
                    <tr v-if='content.Anti_theft_device'>
                        <td style="border:1px #fff solid;">防盜裝置</td>
                        <td>{{content.Anti_theft_device}}</td>
                    </tr>
                    <tr v-if='content.Cushion'>
                        <td style="border:1px #fff solid;">坐墊開啟</td>
                        <td>{{content.Cushion}}</td>
                    </tr>
                    <tr v-if='content.other'>
                        <td style="border:1px #fff solid;">其他</td>
                        <td>{{content.other}}</td>
                    </tr>
                </table>
                <button @click='clickHandler(content.name,1)' >加入購物車</button>
            </div>
        </section>
    </main>

    <footer>
        Copyright © 2021 109年電子商務網站建置(臺中)第2期第八組. All rights reserved.
    </footer>
    <script src='js/nav.js'></script>
    <script>
            let vm = new Vue({
            el:'#productContent',
            data(){
                return{
                    resdata:null,
                    selected:'',
                    id:'',
                    status:false,
                }
            },
            computed:{
                content(){
                    if(this.resdata!=null){
                        if(this.selected ===''){
                            return this.resdata[0];
                        }
                        else{
                            return this.resdata[this.resdata.findIndex(x => x.name === this.selected)];
                        }
                    }
                    else{
                        return {};
                    }
                },
                price(){
                    if(this.resdata!=null){
                        return this.content.price.replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g, ",");
                    }
                    else{
                        return 0;
                    }
                },
                
            },
            created(){
                this.id = location.href;
                let index = this.id.indexOf('=');
                let id_Number = '';
                for(let i = index +1 ; i<this.id.length; i++){
                    id_Number += this.id[i];
                }
                this.id = id_Number*1;
                axios.post('productContent.php', JSON.stringify({id:this.id}))
                    .then(res=>{
                        this.resdata = res.data;
                        this.status = true;
                        document.title = this.resdata[0].typename;
                    });
            },
            methods:{
                clickHandler(productName,number){
                    if(!number) {number =1;}
                    if(Cookies.get('shoppingCart')){
                        let oldData = Cookies.get('shoppingCart'); 
                        let strIndex =  oldData.indexOf(`${productName}`);
                        if(strIndex !== -1){
                            let newDataLen  = productName.length;
                            let i;
                            for(i = strIndex+newDataLen+2;i< oldData.length;i++){
                                if(oldData[i] === ';'){
                                    break;
                                }
                            }
                            let oldNumber = oldData.slice(strIndex+newDataLen+2,i) *1;
                            let newNumber  = oldNumber + number;
                            let newData = oldData.replace(`${productName}n=${oldNumber}`,`${productName}n=${newNumber}`);
                            Cookies.set('shoppingCart',newData);
                            console.log(Cookies.get('shoppingCart'));
                        }
                        else{
                            let productData = oldData+';'+productName+'n='+number;
                            Cookies.set('shoppingCart',productData);
                            console.log(Cookies.get('shoppingCart'));
                        }
                    }
                    else{
                        Cookies.set('shoppingCart',productName+'n='+number);
                        console.log(Cookies.get('shoppingCart'));
                    }
                    alert('商品已放入購物車');
                },
                clear(){
                    Cookies.set('shoppingCart','');
                    console.log(Cookies.get('shoppingCart'));
                },
            },
        });

        let headerVm = new Vue({
                el:'#header',
                data:{
                    status:false,
                },
                computed:{
                    headerSrc(){
                        if(vm.status){
                            if(vm.resdata!=null){
                                this.status = true;
                                return vm.content.banner;
                            }
                            else{
                                this.status = true;
                            }
                        }
                        else{
                            return null;
                        }
                    },
                    id(){
                        if(vm.resdata!=null){
                            return vm.id;
                        }
                        else{
                            return null;
                        }
                    }
                },
            });




    </script>
</body>
</html>